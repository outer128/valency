<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extra Questions</title>
    <link rel="stylesheet" href="new-style.css">
    <style>
        .puzzle-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="logo.png" alt="VALENCY Logo" class="logo">
        <h2>Extra Questions</h2>
        
        <div class="puzzle-section">
            <h3>問題 1</h3>
            <div id="grid-inner-1"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-1"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 2</h3>
            <div id="grid-inner-2"></div>
            <button onclick="checkPuzzle(2)">回答をチェック</button>
            <div id="message-area-2"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 3</h3>
            <div id="grid-inner-3"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-3"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 4</h3>
            <div id="grid-inner-4"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-4"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 5</h3>
            <div id="grid-inner-5"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-5"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 6</h3>
            <div id="grid-inner-6"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-6"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 7</h3>
            <div id="grid-inner-7"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-7"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 8</h3>
            <div id="grid-inner-8"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-8"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 9</h3>
            <div id="grid-inner-9"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-9"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 10</h3>
            <div id="grid-inner-10"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-10"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 11</h3>
            <div id="grid-inner-11"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-11"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 12</h3>
            <div id="grid-inner-12"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-12"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 13</h3>
            <div id="grid-inner-13"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-13"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 14</h3>
            <div id="grid-inner-14"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-14"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 15</h3>
            <div id="grid-inner-15"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-15"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 16</h3>
            <div id="grid-inner-16"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-16"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 17</h3>
            <div id="grid-inner-17"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-17"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 18</h3>
            <div id="grid-inner-18"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-18"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 19</h3>
            <div id="grid-inner-19"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-19"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 20</h3>
            <div id="grid-inner-20"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-20"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 21</h3>
            <div id="grid-inner-21"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-21"></div>
        </div>

        <div class="puzzle-section">
            <h3>問題 22</h3>
            <div id="grid-inner-22"></div>
            <button onclick="checkPuzzle(1)">回答をチェック</button>
            <div id="message-area-22"></div>
        </div>
        
        <div id="all-clear-link" style="display: none; margin-top: 40px;">
            <a href="extra-clear.html" class="next-stage-button">全問正解！次のサイトへ進む</a>
        </div>
    </div>


    <script>
        // --- 1. 5問分のデータ定義 ---
        const puzzleData = [
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},
          
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},
        ];

        // --- 2. ゲームインスタンスの格納用配列 ---
        const gameInstances = [];

        // --- 3. 全問の正解ステータス ---
        let solvedStatus = new Array(puzzleData.length).fill(false);
        const wrapper = document.getElementById('puzzles-wrapper'); // 新しいラッパー要素を取得

        // --- 4. ページロード時の初期化処理 ---
        document.addEventListener('DOMContentLoaded', () => {
            puzzleData.forEach((data, index) => {
                const puzzleNumber = index + 1
                // ★★★ 10問ごとにサブタイトルを挿入するロジック ★★★
                if ((puzzleNumber - 1) % 10 === 0) {
                    // 例: 1問目、11問目、21問目...
                    const subtitle = document.createElement('h3');
                    subtitle.classList.add('puzzle-subtitle');
            
                    let titleText = `セクション ${Math.floor(index / 10) + 1}`;
                    
                    // 例外的なサブタイトルを定義 (必要に応じて追加)
                    if (puzzleNumber === 11) {
                        titleText = "セクション 2: ここからの10問は、6x6の問題です";
                    } else if (puzzleNumber === 21) {
                        titleText = "セクション 3: 3x5の特殊な問題です";
                    }
            
                    subtitle.textContent = titleText;
                    wrapper.appendChild(subtitle);
                }
                // ★★★ サブタイトル挿入ロジック終了 

                // --- パズルセクションの生成 ---
                const section = document.createElement('div');
                section.classList.add('puzzle-section');
        
                // 問題タイトル
                const questionTitle = document.createElement('h3');
                questionTitle.textContent = `問題 ${puzzleNumber}`;
                section.appendChild(questionTitle);

                // グリッドコンテナ
                const gridInnerId = `grid-inner-${puzzleNumber}`;
                const gridInner = document.createElement('div');
                gridInner.id = gridInnerId;
                section.appendChild(gridInner);

                // チェックボタン
                const checkButton = document.createElement('button');
                checkButton.textContent = '回答をチェック';
                // クリックイベントハンドラを動的に設定
                checkButton.onclick = () => checkPuzzle(puzzleNumber);
                section.appendChild(checkButton);

                // メッセージエリア
                const messageAreaId = `message-area-${puzzleNumber}`;
                const messageArea = document.createElement('div');
                messageArea.id = messageAreaId;
                section.appendChild(messageArea);
        
                // ラッパーに追加
                wrapper.appendChild(section);

                // ValencyGame インスタンスを作成
                const game = new ValencyGame(data, gridInnerId, messageAreaId);
                gameInstances.push(game);
            });
        });

        // --- 5. チェックボタンが押されたときの処理 ---
        // (HTMLの onclick="checkPuzzle(N)" から呼び出される)
        function checkPuzzle(puzzleNumber) {
            const index = puzzleNumber - 1;
            const game = gameInstances[index];
            
            // 該当パズルの checkAnswer メソッドを実行
            const isCorrect = game.checkAnswer();

            if (isCorrect) {
                solvedStatus[index] = true; // 正解状態を保存
            }

            // 全問正解チェック
            const allSolved = solvedStatus.every(status => status === true);

            if (allSolved) {
                document.getElementById('all-clear-link').style.display = 'block';
            }
        }
    </script>
    
    <script src="new-game-logic.js"></script>
</body>
</html>
