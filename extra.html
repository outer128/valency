<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extra Questions</title>
    <link rel="stylesheet" href="new-style.css">
    <style>
        .puzzle-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="logo.png" alt="VALENCY Logo" class="logo">
        <h2>Extra Questions</h2>
        
        <div class="puzzle-section">
            <h3>å•é¡Œ 1</h3>
            <div id="grid-inner-1"></div>
            <button onclick="checkPuzzle(1)">å›ç­”ã‚’ãƒã‚§ãƒƒã‚¯</button>
            <div id="message-area-1"></div>
        </div>

        <div class="puzzle-section">
            <h3>å•é¡Œ 2</h3>
            <div id="grid-inner-2"></div>
            <button onclick="checkPuzzle(2)">å›ç­”ã‚’ãƒã‚§ãƒƒã‚¯</button>
            <div id="message-area-2"></div>
        </div>
        
        <div id="all-clear-link" style="display: none; margin-top: 40px;">
            <a href="next-site.html" class="next-stage-button">ğŸ‰ å…¨å•æ­£è§£ï¼æ¬¡ã®ã‚µã‚¤ãƒˆã¸é€²ã‚€</a>
        </div>
    </div>


    <script>
        // --- 1. 5å•åˆ†ã®ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
        const puzzleData = [
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},
          
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},
        ];

        // --- 2. ã‚²ãƒ¼ãƒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ ¼ç´ç”¨é…åˆ— ---
        const gameInstances = [];

        // --- 3. å…¨å•ã®æ­£è§£ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ ---
        let solvedStatus = new Array(puzzleData.length).fill(false);

        // --- 4. ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ–å‡¦ç† ---
        document.addEventListener('DOMContentLoaded', () => {
            puzzleData.forEach((data, index) => {
                const puzzleNumber = index + 1;
                const containerId = `grid-inner-${puzzleNumber}`;
                const messageId = `message-area-${puzzleNumber}`;

                // 5ã¤ã®ç‹¬ç«‹ã—ãŸã‚²ãƒ¼ãƒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
                const game = new ValencyGame(data, containerId, messageId);
                gameInstances.push(game);
            });
        });

        // --- 5. ãƒã‚§ãƒƒã‚¯ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã®å‡¦ç† ---
        // (HTMLã® onclick="checkPuzzle(N)" ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹)
        function checkPuzzle(puzzleNumber) {
            const index = puzzleNumber - 1;
            const game = gameInstances[index];
            
            // è©²å½“ãƒ‘ã‚ºãƒ«ã® checkAnswer ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œ
            const isCorrect = game.checkAnswer();

            if (isCorrect) {
                solvedStatus[index] = true; // æ­£è§£çŠ¶æ…‹ã‚’ä¿å­˜
            }

            // å…¨å•æ­£è§£ãƒã‚§ãƒƒã‚¯
            const allSolved = solvedStatus.every(status => status === true);

            if (allSolved) {
                document.getElementById('all-clear-link').style.display = 'block';
            }
        }
    </script>
    
    <script src="new-game-logic.js"></script>
</body>
</html>
