<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extra Questions</title>
    <link rel="stylesheet" href="new-style.css">
    <style>
        .puzzle-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="logo.png" alt="VALENCY Logo" class="logo">
        <h1>Extra Questions</h1>
        
        <div id="puzzles-wrapper">
            </div>
        
        <div id="all-clear-link" style="display: none; margin-top: 40px;">
            <a href="extra-clear.html" class="next-stage-button">全問正解！次のサイトへ進む</a>
        </div>
    </div>


    <script>
        const sectionTitles = {
            1: "セクション 1: 3x4",
            6: "セクション 2: 4x4",
            11: "セクション 3: 4x5",
            16: "セクション 3: 5x6",
            21: "セクション 3: 6x6",
            31: "セクション 4: 6x7",
            41: "セクション 6: Blank",
            61: "セクション 7: Error",
            81: "セクション 8: +1",
        };
        
        // --- 1. 100問分のデータ定義 ---
        const puzzleData = [
            // 1問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 1, value: 2, color: '#ffadad' },
                { row: 1, col: 0, value: 3, color: '#ffd6a5' },
                { row: 1, col: 3, value: 3, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 3, value: 2, color: '#bdb2ff' }
            ], 
            solution: new Set([
                "0,0-0,1","0,1-1,1","0,2-0,3","0,2-1,2","1,0-2,0","1,1-1,2","1,1-2,1","1,2-2,2","1,3-2,3","2,1-2,2"
            ])},

            // 2問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 1, color: '#ffadad' },
                { row: 0, col: 1, value: 3, color: '#ffd6a5' },
                { row: 0, col: 2, value: 3, color: '#caffb6' },
                { row: 2, col: 1, value: 3, color: '#9bf6ff' },
                { row: 2, col: 3, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-0,1","0,0-1,0","0,1-0,2","0,3-1,3","1,0-2,0","1,1-1,2","1,1-2,1","1,2-1,3","1,2-2,2","2,2-2,3"
            ])},

            
            // 3問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 1, color: '#ffadad' },
                { row: 0, col: 2, value: 3, color: '#ffd6a5' },
                { row: 0, col: 3, value: 1, color: '#caffb6' },
                { row: 1, col: 1, value: 3, color: '#9bf6ff' },
                { row: 2, col: 1, value: 2, color: '#bdb2ff' },
                { row: 2, col: 2, value: 2, color: '#ffc6ff' }
            ],
            solution: new Set([
                "0,0-0,1","0,0-1,0","0,1-0,2","0,2-0,3","0,3-1,3","1,0-2,0","1,1-1,2","1,1-2,1","1,2-2,2","1,3-2,3","2,1-2,2"
            ])},

            // 4問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 2, value: 2, color: '#ffadad' },
                { row: 1, col: 2, value: 3, color: '#ffd6a5' },
                { row: 2, col: 0, value: 1, color: '#caffb6' },
                { row: 2, col: 1, value: 4, color: '#9bf6ff' },
                { row: 2, col: 3, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-0,1","0,1-1,1","0,2-0,3","0,2-1,2","1,0-2,0","1,1-1,2","1,2-2,2","1,3-2,3","2,0-2,1","2,1-2,2"
            ])},

            // 5問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 0, col: 2, value: 2, color: '#ffd6a5' },
                { row: 1, col: 1, value: 4, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0","0,1-0,2","0,1-1,1","0,2-1,2","0,3-1,3","1,0-2,0","1,1-2,1","1,2-2,2","1,3-2,3","2,1-2,2"
            ])},

            
            // 6問目
            {height: 4, width: 4, numbers: [
                { row: 0, col: 0, value: 1, color: '#ffadad' },
                { row: 0, col: 1, value: 3, color: '#ffd6a5' },
                { row: 0, col: 3, value: 1, color: '#caffb6' },
                { row: 1, col: 3, value: 3, color: '#9bf6ff' },
                { row: 2, col: 0, value: 3, color: '#bdb2ff' },
                { row: 3, col: 0, value: 1, color: '#ffc6ff' },
                { row: 3, col: 2, value: 3, color: '#fff65c' },
                { row: 3, col: 3, value: 1, color: '#e4e4e4' }
            ], 
            solution: new Set([
                "0,0-0,1","0,0-1,0","0,1-0,2","0,2-0,3","0,3-1,3","1,0-2,0","1,1-1,2","1,1-2,1","1,2-2,2","1,3-2,3","2,0-3,0","2,1-2,2","2,3-3,3","3,0-3,1","3,1-3,2","3,2-3,3"
            ])},

            // 7問目
            {height: 4, width: 4, numbers: [
                { row: 0, col: 1, value: 2, color: '#ffadad' },
                { row: 1, col: 0, value: 3, color: '#ffd6a5' },
                { row: 1, col: 2, value: 3, color: '#caffb6' },
                { row: 2, col: 1, value: 4, color: '#9bf6ff' },
                { row: 3, col: 0, value: 2, color: '#bdb2ff' },
                { row: 3, col: 3, value: 2, color: '#ffc6ff' }
            ],
            solution: new Set([
                "0,0-0,1","0,1-1,1","0,2-0,3","0,2-1,2","1,0-2,0","1,1-1,2","1,1-2,1","1,2-2,2","1,3-2,3","2,0-3,0","2,1-3,1","2,2-3,2","2,3-3,3","3,1-3,2"
            ])},

            
            // 8問目
            {height: 4, width: 4, numbers: [
                { row: 0, col: 1, value: 2, color: '#ffadad' },
                { row: 0, col: 3, value: 1, color: '#ffd6a5' },
                { row: 1, col: 3, value: 4, color: '#caffb6' },
                { row: 2, col: 1, value: 3, color: '#9bf6ff' },
                { row: 3, col: 0, value: 4, color: '#bdb2ff' },
                { row: 3, col: 3, value: 2, color: '#ffc6ff' }
            ],
            solution: new Set([
                "0,0-1,0","0,1-0,2","0,1-1,1","0,2-0,3","0,3-1,3","1,0-1,1","1,1-2,1","1,2-2,2","1,3-2,3","2,0-2,1","2,1-3,1","2,2-3,2","2,3-3,3","3,1-3,2"
            ])},

            // 9問目
            {height: 4, width: 4, numbers: [
                { row: 1, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 3, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 5, color: '#9bf6ff' },
                { row: 3, col: 0, value: 2, color: '#bdb2ff' },
                { row: 3, col: 2, value: 2, color: '#ffc6ff' }
            ],
            solution: new Set([
                "0,0-0,1","0,2-0,3","0,2-1,2","1,0-1,1","1,0-2,0","1,1-1,2","1,1-2,1","1,2-1,3","1,3-2,3","2,0-3,0","2,1-3,1","2,2-3,2","2,3-3,3","3,1-3,2"
            ])},

            // 10問目
            {height: 4, width: 4, numbers: [
                { row: 0, col: 0, value: 1, color: '#ffadad' },
                { row: 1, col: 2, value: 3, color: '#ffd6a5' },
                { row: 2, col: 0, value: 2, color: '#caffb6' },
                { row: 2, col: 1, value: 4, color: '#9bf6ff' },
                { row: 2, col: 2, value: 4, color: '#bdb2ff' },
                { row: 2, col: 3, value: 2, color: '#ffc6ff' }
            ],
            solution: new Set([
                "0,0-0,1","0,0-1,0","0,1-0,2","0,3-1,3","1,0-2,0","1,1-1,2","1,2-1,3","1,2-2,2","2,0-2,1","2,1-2,2","2,1-3,1","2,2-2,3","2,3-3,3","3,0-3,1"
            ])},

            

            // 11問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 12問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 13問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 14問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 15問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 16問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 17問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 18問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 19問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 20問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 21問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},

            // 22問目
            {height: 3, width: 4, numbers: [
                { row: 0, col: 0, value: 2, color: '#ffadad' },
                { row: 1, col: 1, value: 4, color: '#ffd6a5' },
                { row: 1, col: 3, value: 2, color: '#caffb6' },
                { row: 2, col: 0, value: 2, color: '#9bf6ff' },
                { row: 2, col: 2, value: 2, color: '#bdb2ff' }
            ],
            solution: new Set([
                "0,0-1,0",
                "0,1-0,2",
                "0,1-1,1",
                "0,2-0,3",
                "1,0-1,1",
                "1,2-1,3",
                "1,2-2,2",
                "1,3-2,3",
                "2,0-2,1",
                "2,1-2,2"
            ])},
        ];


        // --- 2. ゲームインスタンスの格納用配列 ---
        const gameInstances = [];

        // --- 3. 全問の正解ステータス ---
        let solvedStatus = new Array(puzzleData.length).fill(false);
        const wrapper = document.getElementById('puzzles-wrapper'); // 新しいラッパー要素を取得

        // --- 4. ページロード時の初期化処理 ---
        document.addEventListener('DOMContentLoaded', () => {
            puzzleData.forEach((data, index) => {
                const puzzleNumber = index + 1
                if (sectionTitles[puzzleNumber]) {
                    const subtitle = document.createElement('h3');
                    subtitle.classList.add('puzzle-subtitle');
            
                    const titleText = sectionTitles[puzzleNumber];
            
                    subtitle.textContent = titleText;
                    wrapper.appendChild(subtitle);
                }

                // --- パズルセクションの生成 ---
                const section = document.createElement('div');
                section.classList.add('puzzle-section');
        
                // 問題タイトル
                const questionTitle = document.createElement('h3');
                questionTitle.textContent = `問題 ${puzzleNumber}`;
                section.appendChild(questionTitle);

                // グリッドコンテナ
                const gridInnerId = `grid-inner-${puzzleNumber}`;
                const gridInner = document.createElement('div');
                gridInner.id = gridInnerId;
                section.appendChild(gridInner);

                // チェックボタン
                const checkButton = document.createElement('button');
                checkButton.textContent = '回答をチェック';
                // クリックイベントハンドラを動的に設定
                checkButton.onclick = () => checkPuzzle(puzzleNumber);
                section.appendChild(checkButton);

                // メッセージエリア
                const messageAreaId = `message-area-${puzzleNumber}`;
                const messageArea = document.createElement('div');
                messageArea.id = messageAreaId;
                section.appendChild(messageArea);
        
                // ラッパーに追加
                wrapper.appendChild(section);

                // ValencyGame インスタンスを作成
                const game = new ValencyGame(data, gridInnerId, messageAreaId);
                gameInstances.push(game);
            });
        });

        // --- 5. チェックボタンが押されたときの処理 ---
        // (HTMLの onclick="checkPuzzle(N)" から呼び出される)
        function checkPuzzle(puzzleNumber) {
            const index = puzzleNumber - 1;
            const game = gameInstances[index];
            
            // 該当パズルの checkAnswer メソッドを実行
            const isCorrect = game.checkAnswer();

            if (isCorrect) {
                solvedStatus[index] = true; // 正解状態を保存
            }

            // 全問正解チェック
            const allSolved = solvedStatus.every(status => status === true);

            if (allSolved) {
                document.getElementById('all-clear-link').style.display = 'block';
            }
        }
    </script>
    
    <script src="new-game-logic.js"></script>
</body>
</html>
